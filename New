import requests
import time

# ğŸ” Din Telegram-bot token
TOKEN = 'ERSÃ„TT_MED_DIN_TOKEN'
CHAT_ID = 123456789  # â† Byt ut mot ditt riktiga chat-ID (frÃ¥n @userinfobot)

def hamta_jobben(yrke, plats):
    url = "https://jobsearch.api.jobtechdev.se/search"
    params = {
        "q": yrke,
        "region": plats,
        "limit": 5
    }
    headers = {
        "Accept": "application/json"
    }
    response = requests.get(url, params=params, headers=headers)
    resultat = []
    if response.status_code == 200:
        data = response.json()
        for annons in data.get("hits", []):
            titel = annons['headline']
            lÃ¤nk = annons['webpage_url']
            resultat.append(f"{titel}\n{lÃ¤nk}")
    else:
        resultat.append(f"âŒ Kunde inte hÃ¤mta {yrke}-jobb. Statuskod: {response.status_code}")
    return resultat

def skicka_telegrammeddelande(text):
    url = f"https://api.telegram.org/bot{TOKEN}/sendMessage"
    data = {
        "chat_id": CHAT_ID,
        "text": text
    }
    r = requests.post(url, data=data)
    if r.status_code != 200:
        print(f"Fel vid skickning: {r.status_code}, {r.text}")

# ğŸ Starta jobbsÃ¶kning
lagerjobb = hamta_jobben("lager", "Stockholm")
butiksjobb = hamta_jobben("butik", "Stockholm")

# ğŸ“¤ Skicka till Telegram
skicka_telegrammeddelande("ğŸ“¦ Lagerjobb i Stockholm:")
for jobb in lagerjobb:
    skicka_telegrammeddelande(jobb)
    time.sleep(1)

skicka_telegrammeddelande("ğŸ›’ Butiksjobb i Stockholm:")
for jobb in butiksjobb:
    skicka_telegrammeddelande(jobb)
    time.sleep(1)
